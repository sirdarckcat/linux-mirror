(()=>{var t={891:function(t){t.exports=(()=>{"use strict";var t={870:(t,e,r)=>{r.r(e),r.d(e,{createEndpoint:()=>o,expose:()=>l,proxy:()=>E,proxyMarker:()=>n,releaseProxy:()=>i,transfer:()=>g,transferHandlers:()=>c,windowEndpoint:()=>b,wrap:()=>m});const n=Symbol("Comlink.proxy"),o=Symbol("Comlink.endpoint"),i=Symbol("Comlink.releaseProxy"),s=Symbol("Comlink.thrown"),a=t=>"object"==typeof t&&null!==t||"function"==typeof t,c=new Map([["proxy",{canHandle:t=>a(t)&&t[n],serialize(t){const{port1:e,port2:r}=new MessageChannel;return l(t,e),[r,[r]]},deserialize:t=>(t.start(),m(t))}],["throw",{canHandle:t=>a(t)&&s in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function l(t,e=self){e.addEventListener("message",(function r(n){if(!n||!n.data)return;const{id:o,type:i,path:a}=Object.assign({path:[]},n.data),c=(n.data.argumentList||[]).map(w);let m;try{const e=a.slice(0,-1).reduce(((t,e)=>t[e]),t),r=a.reduce(((t,e)=>t[e]),t);switch(i){case 0:m=r;break;case 1:e[a.slice(-1)[0]]=w(n.data.value),m=!0;break;case 2:m=r.apply(e,c);break;case 3:m=E(new r(...c));break;case 4:{const{port1:e,port2:r}=new MessageChannel;l(t,r),m=g(e,[e])}break;case 5:m=void 0}}catch(t){m={value:t,[s]:0}}Promise.resolve(m).catch((t=>({value:t,[s]:0}))).then((t=>{const[n,s]=y(t);e.postMessage(Object.assign(Object.assign({},n),{id:o}),s),5===i&&(e.removeEventListener("message",r),u(e))}))})),e.start&&e.start()}function u(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function m(t,e){return d(t,[],e)}function f(t){if(t)throw new Error("Proxy has been released and is not useable")}function d(t,e=[],r=function(){}){let n=!1;const s=new Proxy(r,{get(r,o){if(f(n),o===i)return()=>v(t,{type:5,path:e.map((t=>t.toString()))}).then((()=>{u(t),n=!0}));if("then"===o){if(0===e.length)return{then:()=>s};const r=v(t,{type:0,path:e.map((t=>t.toString()))}).then(w);return r.then.bind(r)}return d(t,[...e,o])},set(r,o,i){f(n);const[s,a]=y(i);return v(t,{type:1,path:[...e,o].map((t=>t.toString())),value:s},a).then(w)},apply(r,i,s){f(n);const a=e[e.length-1];if(a===o)return v(t,{type:4}).then(w);if("bind"===a)return d(t,e.slice(0,-1));const[c,l]=h(s);return v(t,{type:2,path:e.map((t=>t.toString())),argumentList:c},l).then(w)},construct(r,o){f(n);const[i,s]=h(o);return v(t,{type:3,path:e.map((t=>t.toString())),argumentList:i},s).then(w)}});return s}function h(t){const e=t.map(y);return[e.map((t=>t[0])),(r=e.map((t=>t[1])),Array.prototype.concat.apply([],r))];var r}const p=new WeakMap;function g(t,e){return p.set(t,e),t}function E(t){return Object.assign(t,{[n]:!0})}function b(t,e=self,r="*"){return{postMessage:(e,n)=>t.postMessage(e,r,n),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e)}}function y(t){for(const[e,r]of c)if(r.canHandle(t)){const[n,o]=r.serialize(t);return[{type:3,name:e,value:n},o]}return[{type:0,value:t},p.get(t)||[]]}function w(t){switch(t.type){case 3:return c.get(t.name).deserialize(t.value);case 0:return t.value}}function v(t,e,r){return new Promise((n=>{const o=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join("-");t.addEventListener("message",(function e(r){r.data&&r.data.id&&r.data.id===o&&(t.removeEventListener("message",e),n(r.data))})),t.start&&t.start(),t.postMessage(Object.assign({id:o},e),r)}))}},162:function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return o(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.createDbWorker=void 0;const s=i(r(870));async function a(t){if(t.data&&"eval"===t.data.action){const e=new Int32Array(t.data.notify,0,2),r=new Uint8Array(t.data.notify,8);let n;try{n={ok:await u(t.data.request)}}catch(e){console.error("worker request error",t.data.request,e),n={err:String(e)}}const o=(new TextEncoder).encode(JSON.stringify(n));r.set(o,0),e[1]=o.length,Atomics.notify(e,0)}}function c(t){if("BODY"===t.tagName)return"body";const e=[];for(;t.parentElement&&"BODY"!==t.tagName;){if(t.id){e.unshift("#"+t.id);break}{let r=1,n=t;for(;n.previousElementSibling;)n=n.previousElementSibling,r++;e.unshift(t.tagName.toLowerCase()+":nth-child("+r+")")}t=t.parentElement}return e.join(" > ")}function l(t){return Object.keys(t)}async function u(t){if(console.log("dom vtable request",t),"select"===t.type)return[...document.querySelectorAll(t.selector)].map((e=>{const r={};for(const n of t.columns)"selector"===n?r.selector=c(e):"parent"===n?e.parentElement&&(r.parent=e.parentElement?c(e.parentElement):null):"idx"===n||(r[n]=e[n]);return r}));if("insert"===t.type){if(!t.value.parent)throw Error('"parent" column must be set when inserting');const e=document.querySelectorAll(t.value.parent);if(0===e.length)throw Error(`Parent element ${t.value.parent} could not be found`);if(e.length>1)throw Error(`Parent element ${t.value.parent} ambiguous (${e.length} results)`);const r=e[0];if(!t.value.tagName)throw Error("tagName must be set for inserting");const n=document.createElement(t.value.tagName);for(const e of l(t.value))if(null!==t.value[e]){if("tagName"===e||"parent"===e)continue;if("idx"===e||"selector"===e)throw Error(`${e} can't be set`);n[e]=t.value[e]}return r.appendChild(n),null}if("update"===t.type){const e=document.querySelector(t.value.selector);if(!e)throw Error(`Element ${t.value.selector} not found!`);const r=[];for(const n of l(t.value)){const o=t.value[n];if("parent"!==n){if("idx"!==n&&"selector"!==n&&o!==e[n]){if(console.log("SETTING ",n,e[n],"->",o),"tagName"===n)throw Error("can't change tagName");r.push(n)}}else if(o!==c(e.parentElement)){const t=document.querySelectorAll(o);if(1!==t.length)throw Error(`Invalid target parent: found ${t.length} matches`);t[0].appendChild(e)}}for(const n of r)e[n]=t.value[n];return null}throw Error(`unknown request ${t.type}`)}s.transferHandlers.set("WORKERSQLPROXIES",{canHandle:t=>!1,serialize(t){throw Error("no")},deserialize:t=>(t.start(),s.wrap(t))}),e.createDbWorker=async function(t,e,r){const n=new Worker(e),o=s.wrap(n),i=await o.SplitFileHttpDatabase(r,t);return n.addEventListener("message",a),{db:i,worker:o,configs:t}}},432:function(t,e,r){var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),o=this&&this.__exportStar||function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)};Object.defineProperty(e,"__esModule",{value:!0}),o(r(162),e)}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}return r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(432)})()},611:(t,e,r)=>{"use strict";t.exports=r.p+"c74ad46623e4ee643959.wasm"},421:(t,e,r)=>{"use strict";t.exports=r.p+"03e1cd6585d66bccd5ba.js"}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}r.m=t,r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");n.length&&(t=n[n.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),r.b=document.baseURI||self.location.href,(()=>{"use strict";var t=r(891);const e=new URL(r(421),r.b),n=new URL(r(611),r.b);(new class{constructor(){this.NUM_WORKERS=6,this.CONFIG="https://linux-mirror-db.storage.googleapis.com/config.json",this.REPO="sirdarckcat/linux-1",this.workers=null,this.initialConfig=null}async init(){"/ubuntu/"==location.pathname&&(this.CONFIG="https://linux-mirror-db.storage.googleapis.com/config-ubuntu.json",this.REPO="sirdarckcat/ubuntu"),this.initialConfig=fetch(this.CONFIG);const r=[];for(let o=0;o<this.NUM_WORKERS;o++){const o=(0,t.createDbWorker)([{from:"jsonconfig",configUrl:this.CONFIG}],e.toString(),n.toString());r.push(o)}this.workers=await Promise.all(r),window.onhashchange=()=>this.doit(),this.doit()}async getGithubCommit(t){try{const e=await(await fetch(`https://api.github.com/repos/${this.REPO}/commits/${encodeURI(t)}`)).json();return void 0===e.sha||void 0===e.commit?{sha:t,commit:{message:"[!] GitHub error: "+e.message}}:e}catch(e){return{sha:t,commit:{message:"[!] Fetch error: "+e}}}}async load(t){if(!this.workers)throw new Error("Workers are not initialized.");let e=[],r="",n=[],o="";if(t.match(/^CVE-\d+-\d+$/)){if(r=t,e=await this.workers[5].db.query("SELECT `commit` FROM cve WHERE cve = ?",[r]),!e||!e.length)throw new Error("No commit exists for this CVE");t=e[0].commit}else if(t.match(/^id=[0-9a-f]+$/)){if(o=t,n=await this.workers[5].db.query("SELECT `commit` FROM syzkaller WHERE 'id='||syzkaller = ?",[o]),!n||!n.length)throw new Error("No commit exists for this Syzkaller scan");t=n[0].commit}let i=null;if(t.length<40){if(i=await this.getGithubCommit(t),!i.sha)throw new Error("Couldn't find commit "+t);t=i.sha}if(t.length<4||t.length<7&&t.length>=4&&!confirm("Commit is very short - might return too many (or incorrect) results."))throw new Error("Commit is too short");const s=[i||this.getGithubCommit(t),this.workers[0].db.query("SELECT tags FROM tags WHERE `commit` >= ? AND `commit` <= ? || 'g'",[t,t]),this.workers[0].db.query("SELECT upstream FROM upstream WHERE `commit` >= ? AND `commit` <= ? || 'g'",[t,t]),this.workers[1].db.query("SELECT tags, `commit` FROM tags WHERE `commit` IN (SELECT `commit` FROM upstream WHERE upstream >= ? AND upstream <= ? || 'g')",[t,t]),this.workers[0].db.query("SELECT fixes FROM fixes WHERE `commit` >= ? AND `commit` <= ? || 'g' AND LENGTH(fixes)>=4",[t,t]),this.workers[2].db.query("SELECT tags, `commit` FROM tags JOIN (SELECT substr(fixes, 0, instr(fixes, ' ')) trunc FROM fixes WHERE `commit` >= ? AND `commit` <= ? || 'g' AND LENGTH(fixes)>=4) ON (`commit`>trunc AND `commit`<trunc||'g')",[t,t]),this.workers[3].db.query("SELECT tags, `commit` FROM tags WHERE `commit` IN (SELECT `commit` FROM upstream JOIN (SELECT substr(fixes, 0, instr(fixes, ' ')) trunc FROM fixes WHERE `commit` >= ? AND `commit` <= ? || 'g' AND LENGTH(fixes)>=4) ON (upstream>trunc AND upstream<trunc||'g'))",[t,t]),this.workers[4].db.query("SELECT tags, `commit` FROM tags WHERE `commit` IN (SELECT `commit` FROM fixes WHERE LENGTH(fixes)>=4 AND fixes >= substr(?, 1, 4) AND fixes <= ? || 'g' AND SUBSTR(fixes, 0, instr(fixes, ' ')) = SUBSTR(?, 0, instr(fixes, ' ')))",[t,t,t]),this.workers[5].db.query("SELECT 'id='||syzkaller syzkaller, `commit` FROM syzkaller WHERE (`commit` >= ? AND `commit` <= ? || 'g') OR `commit` IN (SELECT `commit` FROM fixes WHERE LENGTH(fixes)>=4 AND fixes >= substr(?, 1, 4) AND fixes <= ? || 'g' AND SUBSTR(fixes, 0, instr(fixes, ' ')) = SUBSTR(?, 0, instr(fixes, ' ')))",[t,t,t,t,t]),this.workers[5].db.query("SELECT cve FROM cve WHERE (`commit` >= ? AND `commit` <= ? || 'g') OR `commit` IN (SELECT `commit` FROM fixes WHERE LENGTH(fixes)>=4 AND fixes >= substr(?, 1, 4) AND fixes <= ? || 'g' AND SUBSTR(fixes, 0, instr(fixes, ' ')) = SUBSTR(?, 0, instr(fixes, ' ')))",[t,t,t,t,t])];let a;if(location.href.match(/__PERF__/)){console.time("promise perf");const t=setInterval((()=>console.log(...s)),100);a=await Promise.all(s.map((async(t,e)=>{const r=await t;return console.timeLog("promise perf"),console.log(e),r}))),clearInterval(t),console.timeEnd("promise perf")}else a=await Promise.all(s);return{...r?{cve:r,"commits associated with cve":e}:{},...o?{syzkaller:o,"commits associated with syzkaller":n}:{},commit:t,details:a.shift().commit.message.split("\n"),"the commit landed on upstream on":a.shift(),"the commit is a backport of":a.shift(),"the commit was backported to":a.shift(),"the commit fixes a bug introduced by":a.shift(),"the buggy commit landed on upstream on":a.shift(),"the buggy commit was backported to":a.shift(),"the commit introduced a bug fixed by":a.shift(),"syzkaller reference for the commit and the fix commit":a.shift(),"cve identifier for the commit and the fix commit":a.shift()}}format(t){const e={};((r,n)=>{const o=e.a=e.a||[];[...t.childNodes].forEach((t=>"#text"==t.nodeName&&t.nodeValue&&t.nodeValue.replace(r,((e,r)=>(o.unshift(document.createRange()),o[0].setStart(t,r),o[0].setEnd(t,r+e.length),e)))))})(/\b(?:(?:id=)?[0-9a-f]{7,40}|CVE-\d+-\d+)\b/g),Object.entries(e).forEach((([t,e])=>e.forEach((e=>e.surroundContents(document.createElement(t)))))),[...t.querySelectorAll("a")].forEach((t=>{t.href="#"+t.textContent}))}async doit(){const t=document.getElementById("output")||document.body;try{let e=location.hash.slice(1);if(t.textContent="Loading "+e,document.body.className="loading",!e)return location.hash="23f57406",void location.reload();const r=await this.load(e);t.textContent=JSON.stringify(r,null,1),this.format(t),document.body.className="done"}catch(e){if(t.textContent=String(e),document.body.className="error",this.initialConfig){const t=await fetch(this.CONFIG,{cache:"reload"}),e=await this.initialConfig;(await t.json()).databaseLengthBytes!=(await e.json()).databaseLengthBytes&&confirm("Database has been updated, reload?")&&location.reload()}}}}).init()})()})();